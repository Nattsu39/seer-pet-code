name: å‘å¸ƒæ‰€æœ‰ Server é•œåƒåˆ° GHCR

# è¿™ä¸ªå·¥ä½œæµå±•ç¤ºäº†å¦‚ä½•åŒæ—¶å‘å¸ƒå¤šä¸ªæœåŠ¡
# å½“ä½ æœ‰ Pythonã€Go ç­‰å…¶ä»– server æ—¶ï¼Œå¯ä»¥åœ¨è¿™é‡Œæ·»åŠ 

# on:
#   push:
#     tags:
#       - 'v*'  # æ‰€æœ‰ç‰ˆæœ¬æ ‡ç­¾
#   workflow_dispatch:
#     inputs:
#       platforms:
#         description: 'æž„å»ºå¹³å°ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰'
#         required: false
#         default: 'linux/amd64,linux/arm64'
#         type: string
#       services:
#         description: 'è¦æž„å»ºçš„æœåŠ¡ï¼ˆç”¨é€—å·åˆ†éš”ï¼šts,py,go æˆ–ç•™ç©ºæž„å»ºå…¨éƒ¨ï¼‰'
#         required: false
#         default: ''
#         type: string

# concurrency:
#   group: all-servers-deploy-${{ github.ref }}
#   cancel-in-progress: false

# jobs:
#   # TypeScript Server
#   publish-ts-server:
#     name: å‘å¸ƒ TypeScript Server
#     if: |
#       inputs.services == '' ||
#       contains(inputs.services, 'ts') ||
#       contains(inputs.services, 'all')
#     uses: ./.github/actions/reusable-docker-build.yml
#     with:
#       service-name: 'TypeScript Server'
#       service-path: 'server/ts'
#       image-name: 'petcode-ts-server'
#       platforms: ${{ inputs.platforms || 'linux/amd64,linux/arm64' }}
#       node-version: '20'
#     secrets: inherit

#   # Python Serverï¼ˆç¤ºä¾‹ - æœªæ¥å¯ä»¥æ·»åŠ ï¼‰
#   # publish-py-server:
#   #   name: å‘å¸ƒ Python Server
#   #   if: |
#   #     inputs.services == '' ||
#   #     contains(inputs.services, 'py') ||
#   #     contains(inputs.services, 'all')
#   #   uses: ./.github/actions/reusable-docker-build.yml
#   #   with:
#   #     service-name: 'Python Server'
#   #     service-path: 'server/py'
#   #     image-name: 'petcode-py-server'
#   #     platforms: ${{ inputs.platforms || 'linux/amd64,linux/arm64' }}
#   #     node-version: ''  # Python ä¸éœ€è¦ Node.js
#   #   secrets: inherit

#   # Go Serverï¼ˆç¤ºä¾‹ - æœªæ¥å¯ä»¥æ·»åŠ ï¼‰
#   # publish-go-server:
#   #   name: å‘å¸ƒ Go Server
#   #   if: |
#   #     inputs.services == '' ||
#   #     contains(inputs.services, 'go') ||
#   #     contains(inputs.services, 'all')
#   #   uses: ./.github/actions/reusable-docker-build.yml
#   #   with:
#   #     service-name: 'Go Server'
#   #     service-path: 'server/go'
#   #     image-name: 'petcode-go-server'
#   #     platforms: ${{ inputs.platforms || 'linux/amd64,linux/arm64' }}
#   #     node-version: ''  # Go ä¸éœ€è¦ Node.js
#   #   secrets: inherit

#   # æ±‡æ€»æ‰€æœ‰å‘å¸ƒç»“æžœ
#   summary:
#     name: å‘å¸ƒæ±‡æ€»
#     runs-on: ubuntu-latest
#     needs: [publish-ts-server]  # æ·»åŠ å…¶ä»– server æ—¶ï¼Œåœ¨è¿™é‡Œæ·»åŠ ä¾èµ–
#     if: always()

#     steps:
#       - name: ç”Ÿæˆå‘å¸ƒæŠ¥å‘Š
#         run: |
#           echo "## ðŸ“¦ Server é•œåƒå‘å¸ƒæŠ¥å‘Š" >> $GITHUB_STEP_SUMMARY
#           echo "" >> $GITHUB_STEP_SUMMARY
#           echo "### å‘å¸ƒç»“æžœ" >> $GITHUB_STEP_SUMMARY
#           echo "" >> $GITHUB_STEP_SUMMARY

#           if [ "${{ needs.publish-ts-server.result }}" == "success" ]; then
#             echo "- âœ… TypeScript Server: å‘å¸ƒæˆåŠŸ" >> $GITHUB_STEP_SUMMARY
#           else
#             echo "- âŒ TypeScript Server: ${{ needs.publish-ts-server.result }}" >> $GITHUB_STEP_SUMMARY
#           fi

#           # æœªæ¥æ·»åŠ å…¶ä»– server çš„çŠ¶æ€æ£€æŸ¥
#           # if [ "${{ needs.publish-py-server.result }}" == "success" ]; then
#           #   echo "- âœ… Python Server: å‘å¸ƒæˆåŠŸ" >> $GITHUB_STEP_SUMMARY
#           # fi

#           echo "" >> $GITHUB_STEP_SUMMARY
#           echo "### ðŸ“ ä½¿ç”¨è¯´æ˜Ž" >> $GITHUB_STEP_SUMMARY
#           echo "" >> $GITHUB_STEP_SUMMARY
#           echo "æ‹‰å–é•œåƒï¼š" >> $GITHUB_STEP_SUMMARY
#           echo '```bash' >> $GITHUB_STEP_SUMMARY
#           echo "# TypeScript Server" >> $GITHUB_STEP_SUMMARY
#           echo "docker pull ghcr.io/${{ github.repository_owner }}/petcode-ts-server:latest" >> $GITHUB_STEP_SUMMARY
#           echo "" >> $GITHUB_STEP_SUMMARY
#           echo "# è¿è¡Œå®¹å™¨" >> $GITHUB_STEP_SUMMARY
#           echo "docker run -p 8080:8080 ghcr.io/${{ github.repository_owner }}/petcode-ts-server:latest" >> $GITHUB_STEP_SUMMARY
#           echo '```' >> $GITHUB_STEP_SUMMARY

